!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.LingOssUpload=t():e.LingOssUpload=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(1)),s=r(n(3)),o=r(n(6)),a=n(7),c=function(){function e(e,t){if(void 0===t&&(t={rootDir:"formal/"}),this.ossInfo=e,this.options=t,!this.ossAccessId||!this.ossAccessKey)throw new Error("check oss accessId || accessKey")}return Object.defineProperty(e.prototype,"ossAccessId",{get:function(){return this.ossInfo.accessId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ossAccessKey",{get:function(){return this.ossInfo.accessKey},enumerable:!1,configurable:!0}),e.prototype.getPolicyBase64=function(e){var t=[];this.options.rootDir&&t.push(["starts-with","$key",this.options.rootDir]),e&&!Number.isNaN(+e)&&t.push(["content-length-range",0,e]);var n=new Date;n.setDate(n.getDate()+1);var r={expiration:n.toISOString(),conditions:t};return o.default.parse(JSON.stringify(r)).toString(i.default)},e.prototype.getSignature=function(e,t){return s.default(t,e).toString(i.default)},e.prototype.getDirName=function(e){return""==e||e.endsWith("/")?e:e+"/"},e.prototype.getCalculateObjectName=function(e,t){return t?e?"${filename}":""+a.getRandomString():""+a.getRandomString()+a.getSuffix(e)},e.prototype.upload=function(e){var t=e.file,n=e.host,r=e.dirName,i=e.selfName,s=void 0!==i&&i,o=e.limitSize,c=void 0===o?0:o,u=e.limitType,f=void 0===u?"":u,p=e.onProgress,l=void 0===p?function(){}:p,d=e.uploadFile,h=void 0===d?a.ajax:d,g=t.name,y=t.size,v=t.type;if(f&&v){if(!("function"==typeof f?f(t):new RegExp(f+"/(\\S)+","gi").test(v)))return Promise.reject({code:400,data:"",message:"请检查文件类型",success:!1})}if(c&&y&&c<y)return Promise.reject({code:400,data:"",message:"最大上传"+c/1024/1024+"M的文件",success:!1});var m=this.getDirName(r)+this.getCalculateObjectName(g,s),_=this.getPolicyBase64(c),S=new FormData;return S.append("name",t.name),S.append("key",m),S.append("policy",_),S.append("OSSAccessKeyId",this.ossAccessId),S.append("success_action_status","200"),S.append("signature",this.getSignature(this.ossAccessKey,_)),S.append("file",t),new Promise((function(e,t){h(n,S,l).then((function(){e({code:200,data:(n+"/"+m).replace("${filename}",g),message:"上传成功",success:!0})})).catch((function(e){t({code:400,data:"",message:e&&e.message||a.getMessage2Xml(e),success:!1})}))}))},e.prototype.createMiniUploadInfo=function(e){var t=e.dirName,n=e.limitSize,r=void 0===n?0:n,i=this.getCalculateObjectName("",!1),s=this.getPolicyBase64(r),o=this.getSignature(this.ossAccessKey,s);return{name:i,key:this.getDirName(t)+i,success_action_status:200,OSSAccessKeyId:this.ossAccessId,policy:s,signature:o}},e}();t.default=c},function(e,t,n){var r,i,s;e.exports=(s=n(2),i=(r=s).lib.WordArray,r.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp();for(var i=[],s=0;s<n;s+=3)for(var o=(t[s>>>2]>>>24-s%4*8&255)<<16|(t[s+1>>>2]>>>24-(s+1)%4*8&255)<<8|t[s+2>>>2]>>>24-(s+2)%4*8&255,a=0;a<4&&s+.75*a<n;a++)i.push(r.charAt(o>>>6*(3-a)&63));var c=r.charAt(64);if(c)for(;i.length%4;)i.push(c);return i.join("")},parse:function(e){var t=e.length,n=this._map,r=this._reverseMap;if(!r){r=this._reverseMap=[];for(var s=0;s<n.length;s++)r[n.charCodeAt(s)]=s}var o=n.charAt(64);if(o){var a=e.indexOf(o);-1!==a&&(t=a)}return function(e,t,n){for(var r=[],s=0,o=0;o<t;o++)if(o%4){var a=n[e.charCodeAt(o-1)]<<o%4*2,c=n[e.charCodeAt(o)]>>>6-o%4*2;r[s>>>2]|=(a|c)<<24-s%4*8,s++}return i.create(r,s)}(e,t,r)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},s.enc.Base64)},function(e,t,n){var r;e.exports=(r=r||function(e,t){var n=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),r={},i=r.lib={},s=i.Base={extend:function(e){var t=n(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},o=i.WordArray=s.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||c).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,i=e.sigBytes;if(this.clamp(),r%4)for(var s=0;s<i;s++){var o=n[s>>>2]>>>24-s%4*8&255;t[r+s>>>2]|=o<<24-(r+s)%4*8}else for(s=0;s<i;s+=4)t[r+s>>>2]=n[s>>>2];return this.sigBytes+=i,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=s.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n,r=[],i=function(t){t=t;var n=987654321,r=4294967295;return function(){var i=((n=36969*(65535&n)+(n>>16)&r)<<16)+(t=18e3*(65535&t)+(t>>16)&r)&r;return i/=4294967296,(i+=.5)*(e.random()>.5?1:-1)}},s=0;s<t;s+=4){var a=i(4294967296*(n||e.random()));n=987654071*a(),r.push(4294967296*a()|0)}return new o.init(r,t)}}),a=r.enc={},c=a.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i++){var s=t[i>>>2]>>>24-i%4*8&255;r.push((s>>>4).toString(16)),r.push((15&s).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new o.init(n,t/2)}},u=a.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i++){var s=t[i>>>2]>>>24-i%4*8&255;r.push(String.fromCharCode(s))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new o.init(n,t)}},f=a.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},p=i.BufferedBlockAlgorithm=s.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=f.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,i=n.sigBytes,s=this.blockSize,a=i/(4*s),c=(a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0))*s,u=e.min(4*c,i);if(c){for(var f=0;f<c;f+=s)this._doProcessBlock(r,f);var p=r.splice(0,c);n.sigBytes-=u}return new o.init(p,u)},clone:function(){var e=s.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),l=(i.Hasher=p.extend({cfg:s.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new l.HMAC.init(e,n).finalize(t)}}}),r.algo={});return r}(Math),r)},function(e,t,n){var r;e.exports=(r=n(2),n(4),n(5),r.HmacSHA1)},function(e,t,n){var r,i,s,o,a,c,u,f;e.exports=(f=n(2),i=(r=f).lib,s=i.WordArray,o=i.Hasher,a=r.algo,c=[],u=a.SHA1=o.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],s=n[2],o=n[3],a=n[4],u=0;u<80;u++){if(u<16)c[u]=0|e[t+u];else{var f=c[u-3]^c[u-8]^c[u-14]^c[u-16];c[u]=f<<1|f>>>31}var p=(r<<5|r>>>27)+a+c[u];p+=u<20?1518500249+(i&s|~i&o):u<40?1859775393+(i^s^o):u<60?(i&s|i&o|s&o)-1894007588:(i^s^o)-899497514,a=o,o=s,s=i<<30|i>>>2,i=r,r=p}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+s|0,n[3]=n[3]+o|0,n[4]=n[4]+a|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[14+(r+64>>>9<<4)]=Math.floor(n/4294967296),t[15+(r+64>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}}),r.SHA1=o._createHelper(u),r.HmacSHA1=o._createHmacHelper(u),f.SHA1)},function(e,t,n){var r,i,s,o;e.exports=(r=n(2),s=(i=r).lib.Base,o=i.enc.Utf8,void(i.algo.HMAC=s.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=o.parse(t));var n=e.blockSize,r=4*n;t.sigBytes>r&&(t=e.finalize(t)),t.clamp();for(var i=this._oKey=t.clone(),s=this._iKey=t.clone(),a=i.words,c=s.words,u=0;u<n;u++)a[u]^=1549556828,c[u]^=909522486;i.sigBytes=s.sigBytes=r,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,n=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(n))}})))},function(e,t,n){var r;e.exports=(r=n(2),r.enc.Utf8)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ajax=t.getSuffix=t.getRandomString=t.getMessage2Xml=void 0,t.getMessage2Xml=function(e,t){return void 0===t&&(t="上传失败"),window.DOMParser&&(t=(new DOMParser).parseFromString(e,"text/xml").getElementsByTagName("Message")[0].textContent||t),t},t.getRandomString=function(e){void 0===e&&(e=32);for(var t="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",n="",r=0;r<e;r++)n+=t.charAt(Math.floor(Math.random()*t.length));return n},t.getSuffix=function(e){var t=e.lastIndexOf(".");return~t?e.substring(t):""},t.ajax=function(e,t,n){return new Promise((function(r,i){var s=new XMLHttpRequest;s.upload.onprogress=function(e){e.lengthComputable&&n(e)},s.onload=function(){200===s.status?r(s.responseText):i(s.responseText)},s.open("POST",e,!0),s.send(t)}))}}]).default}));